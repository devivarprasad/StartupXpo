<div class="max-w-3xl mx-auto p-6">

  <!-- Loading -->
  <div *ngIf="loading" class="flex justify-center items-center py-10">
    <p class="text-gray-500 text-lg animate-pulse">Loading profile...</p>
  </div>

  <!-- Error -->
  <div *ngIf="saveError && !loading"
       class="text-red-600 bg-red-50 border border-red-200 p-3 rounded-lg text-center mb-4">
    {{ saveError }}
  </div>

  <!-- VIEW MODE -->
  <section
    *ngIf="!loading && !isEditing"
    class="bg-white shadow-xl rounded-2xl p-8 transition-all duration-300">

    <!-- Header -->
    <div class="flex items-center gap-6">
      <div class="relative">
        <div
          class="h-20 w-20 flex items-center justify-center rounded-full bg-indigo-600 text-white text-2xl font-bold uppercase shadow-md ring-4 ring-indigo-100">
          {{ profile.username ? profile.username.charAt(0) : '?' }}
        </div>
      </div>

      <div>
        <h2 class="text-3xl font-semibold text-gray-900">
          {{ profile.username || 'Unnamed User' }}
        </h2>
        <span class="inline-block mt-1 px-3 py-1 text-sm bg-gray-100 rounded-full text-gray-600 capitalize">
          {{ profile.role || 'No role set' }}
        </span>
      </div>
    </div>

    <!-- Divider -->
    <hr class="my-6 border-gray-200" />

    <!-- Info Section -->
    <div class="space-y-6">
      <div>
        <p class="text-gray-500 text-sm">Email</p>
        <p class="text-gray-900 font-medium text-lg">
          {{ profile.email || 'Not provided' }}
        </p>
      </div>

      <div>
        <p class="text-gray-500 text-sm">Location</p>
        <p class="text-gray-900 font-medium text-lg">
          {{ profile.location || 'Not provided' }}
        </p>
      </div>

      <div>
        <p class="text-gray-500 text-sm">Bio</p>
        <p class="text-gray-900 font-medium whitespace-pre-line leading-relaxed">
          {{ profile.bio || 'No bio added yet.' }}
        </p>
      </div>
    </div>

    <!-- Edit Button -->
    <div class="mt-8 flex justify-end">
      <button
        (click)="toggleEdit()"
        class="px-5 py-2.5 bg-indigo-600 hover:bg-indigo-700 text-white rounded-lg font-medium shadow-sm transition-all">
        Edit Profile
      </button>
    </div>
  </section>


  <!-- EDIT MODE -->
  <section
    *ngIf="!loading && isEditing"
    class="bg-white shadow-xl rounded-2xl p-8 transition-all duration-300">

    <h2 class="text-2xl font-semibold text-gray-900 mb-6">Edit Profile</h2>

    <form (ngSubmit)="saveProfile()" #profileForm="ngForm" class="space-y-5">

      <!-- Username -->
      <div>
        <label class="block text-gray-600 mb-1 font-medium">Username</label>
        <input
          type="text"
          [(ngModel)]="profile.username"
          name="username"
          class="w-full p-3 border border-gray-300 rounded-xl shadow-sm focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500 transition-all">
      </div>

      <!-- Email -->
      <div>
        <label class="block text-gray-600 mb-1 font-medium">Email</label>
        <input
          type="email"
          [(ngModel)]="profile.email"
          name="email"
          class="w-full p-3 border border-gray-300 rounded-xl shadow-sm focus:ring-2 focus:ring-indigo-500 transition-all">
      </div>

      <!-- Location -->
      <div>
        <label class="block text-gray-600 mb-1 font-medium">Location</label>
        <input
          type="text"
          [(ngModel)]="profile.location"
          name="location"
          class="w-full p-3 border border-gray-300 rounded-xl shadow-sm focus:ring-2 focus:ring-indigo-500 transition-all">
      </div>

      <!-- Bio -->
      <div>
        <label class="block text-gray-600 mb-1 font-medium">Bio</label>
        <textarea
          [(ngModel)]="profile.bio"
          name="bio"
          rows="4"
          class="w-full p-3 border border-gray-300 rounded-xl shadow-sm focus:ring-2 focus:ring-indigo-500 transition-all"></textarea>
      </div>

      <!-- Buttons -->
      <div class="flex justify-end gap-3 pt-4">
        <button
          type="button"
          (click)="toggleEdit()"
          class="px-5 py-2.5 border border-gray-300 text-gray-700 rounded-lg hover:bg-gray-100 transition-all">
          Cancel
        </button>

        <button
          type="submit"
          class="px-5 py-2.5 bg-indigo-600 text-white rounded-lg hover:bg-indigo-700 font-medium shadow-sm transition-all">
          Save
        </button>
      </div>

    </form>
  </section>
</div>
