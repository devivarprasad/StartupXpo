<div class="message-container">
  
  <!-- LEFT SIDEBAR: User List -->
  <div class="user-sidebar">
    <div class="sidebar-header">
      <h3>Messages</h3>
      <div class="search-box">
        <input 
          type="text" 
          placeholder="Search users..." 
          [(ngModel)]="searchTerm"
          class="search-input">
      </div>
    </div>

    <div class="user-list">
      <div 
        *ngFor="let user of filteredUsers" 
        class="user-item" 
        [class.active]="selectedUser?.id === user.id"
        (click)="selectUser(user)">
      

        <div class="user-info">
          <div class="user-header">
            <span class="user-name">{{ user.username }}</span>
          </div>
          <div class="user-sub">
            <span class="user-role">{{ user.role }}</span>
          </div>
          <div class="message-preview">
            <span class="preview-text">{{ user.lastMessage }}</span>
          </div>
        </div>
      </div>

      <div *ngIf="filteredUsers.length === 0" class="no-users">
        No users found.
      </div>
    </div>
  </div>

  <!-- RIGHT SIDE: Chat Area -->
  <div class="chat-area">
    
    <!-- Empty State -->
    <div *ngIf="!selectedUser" class="empty-chat-state">
      <div class="empty-icon">ðŸ’¬</div>
      <h3>Select a conversation</h3>
      <p>Choose a user from the left to start chatting about potential investments.</p>
    </div>

    <!-- Active Conversation -->
    <div *ngIf="selectedUser" class="chat-content">
      <div class="chat-header">
        <div class="header-details">
          <h4>{{ selectedUser.username }}</h4>
        </div>
      </div>

      <div class="messages-list">
        <div *ngFor="let msg of currentConversation" 
             class="message-bubble" 
             [class.sent]="msg.senderId === currentUser?.id"
             [class.received]="msg.senderId !== currentUser?.id">
          <div class="bubble-content">
            {{ msg.content }}
          </div>
          <span class="msg-time">{{ msg.timestamp | date:'shortTime' }}</span>
        </div>
      </div>

      <div class="chat-input-area">
        <input 
          type="text" 
          [(ngModel)]="newMessageText" 
          (keyup.enter)="sendMessage()"
          placeholder="Type a message..."
          class="message-input">
        <button class="send-btn" (click)="sendMessage()" [disabled]="!newMessageText.trim()">
          Send
        </button>
      </div>
    </div>
  </div>
</div>